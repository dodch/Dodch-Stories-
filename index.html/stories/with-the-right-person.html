<!DOCTYPE html>
<!--
/***************************************************************************************************
 *                                   ** DO NOT COPY - ALL RIGHTS RESERVED **
 *
 * This code is the exclusive property of Dodch Stories and its owner. Unauthorized copying,
 * reproduction, modification, distribution, or any form of use of this code, in whole or in part,
 * is strictly prohibited.
 *
 * The intellectual property rights, including copyright, for this software are protected by
 * international laws and treaties. Any infringement of these rights will be pursued to the
 * fullest extent of the law, which may include civil and criminal charges.
 *
 * Copyright (c) 2024 Dodch Stories. All rights reserved.
 ***************************************************************************************************/
-->
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon links -->
    <link rel="icon" href="../../favicon.ico" sizes="any">
    <link rel="icon" href="../../favicon.svg" type="image/svg+xml" />
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="../../favicon-96x96.png" />
    <!-- FIX: Corrected typo and added 192x192 icon for high-DPI screens. -->
    <link rel="icon" type="image/png" sizes="192x192" href="../../web-app-manifest-192x192.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png" />
    <link rel="manifest" href="../../site.webmanifest" />
    <title>With the right person</title>
    <meta name="description" content="A reflection on how the right person can transform your world, making the simplest moments the most valuable.">
    <!-- SEO: Add a canonical link to specify the preferred URL for this page. -->
    <link rel="canonical" href="https://www.dodchstories.com/stories/with-the-right-person.html" />
    <!-- Hreflang tags for multilingual SEO -->
    <link rel="alternate" hreflang="en" href="https://www.dodchstories.com/stories/with-the-right-person.html" />
    <link rel="alternate" hreflang="fr" href="https://www.dodchstories.com/stories/with-the-right-person.html" />
    <link rel="alternate" hreflang="ar" href="https://www.dodchstories.com/stories/with-the-right-person.html" />
    <link rel="alternate" hreflang="x-default" href="https://www.dodchstories.com/stories/with-the-right-person.html" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../story-style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Licorice&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --main-bg-url-light: url('https://i.ibb.co/Zzm7fGQ7/IMG-2465.jpg');
            --main-bg-url-dark: url("https://i.ibb.co/F4BLKf9t/IMG-2305.jpg");
        }
    </style>
    <!-- NEW: Immediate Anti-Inspection Script.
         Placing this script in the <head> ensures it runs before the page content is rendered,
         making it impossible to open DevTools without an immediate page reload. -->
    <script>
        // FIX: Add a pre-rendering script to prevent "flash of incorrect theme" (FOIT).
        // This runs before the body is rendered, checks for the 'dark' preference,
        // and applies a class to the <html> element immediately.
        (function() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark-mode');
            }
        })();
        // Disable right-click context menu globally.
        document.addEventListener('contextmenu', event => event.preventDefault());

        (function() {
            const check = () => {
                const startTime = performance.now();
                debugger;
                const endTime = performance.now();
                if (endTime - startTime > 160) {
                    window.location.reload();
                }
            };
            // Run the check immediately and on a fast interval.
            check();
            setInterval(check, 250);

            // Block common keyboard shortcuts for DevTools.
            window.addEventListener('keydown', e => {
                if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) || (e.ctrlKey && e.key === 'U')) {
                    window.location.reload();
                }
            });
        })();
    </script>
</head>
<body class="loading">
    <div id="loading-screen">
        <div class="loading-indicator">
            <span>ğŸ«‚</span> <span>ğŸ«‚</span> <span>ğŸ«‚</span> <span>ğŸ«‚</span> <span>ğŸ«‚</span>
        </div>
        <div class="loading-percentage">0%</div>
    </div>
    <div class="fixed-background light-background"></div>
    <div class="fixed-background dark-background"></div>
    <!-- SVG Filter for HQ Glass Effect -->
    <svg style="position: absolute; width: 0; height: 0; overflow: hidden;" aria-hidden="true">
        <filter id="filter-popup">
            <feTurbulence type="fractalNoise" baseFrequency="0.015 0.025" numOctaves="1" result="warp" />
            <feDisplacementMap xChannelSelector="R" yChannelSelector="G" scale="30" in="SourceGraphic" in2="warp" />
        </filter>
    </svg>

    <!-- NEW: Add the top gradient blur vignette -->
    <div class="top-vignette"></div>
    <!-- FIX: Move the fixed buttons OUTSIDE the page-content-wrapper to prevent them from scrolling with the page. -->
    <div class="fixed top-0 left-0 right-0 flex flex-col items-start p-4 space-y-2 z-50">
        <div class="flex justify-center space-x-4 mb-2">
            <button
               id="ar-button"                    class="px-6 py-2 rounded-full transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none glass-button-base shine-button"
           >
               Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
           </button>
           <button
               id="fr-button"                    class="px-6 py-2 rounded-full transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none glass-button-base shine-button"
           >
               FranÃ§ais
           </button>
           <button
               id="en-button"                    class="px-6 py-2 rounded-full transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none glass-button-base shine-button"
           >
               English
           </button>
        </div>
        <!-- REFACTOR: Changed the home button to use a cleaner SVG icon. -->
        <div class="flex items-center space-x-2">
            <button id="back-home-button" class="w-10 h-10 rounded-full transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none glass-button-base back-home-button-custom inline-flex items-center justify-center shine-button" aria-label="Back to Home">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
            </button>
            <!-- NEW: Login Button for Story Page -->
            <div id="auth-container" class="auth-container glass-button-base">
                <button id="loginButton" class="login-button">
                    <span class="login-text">Login</span>
                </button>
            </div>
        </div>
    </div>
    <!-- NEW: Live Visitor Count (moved to the right) -->
    <div id="visitor-count-container" class="fixed top-0 right-0 p-4 z-50 glass-button-base flex items-center px-3 py-1 rounded-full mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
        </svg>
        <span id="visitor-count" class="text-white font-bold text-sm">1</span>
    </div>
    <div id="page-content-wrapper">
        <div id="raw-ar-text" class="language-content" style="display: none;">
               Ù„Ù… ÙŠÙØ¸Ù‡Ø±Ø§Ù„Ù†Ø§Ø³ ÙŠÙˆÙ…Ù‹Ø§ ÙƒÙŠÙ ÙŠØ¨Ø¯Ùˆ Ø§Ù„Ø­Ø¨ Ø­Ù‚Ù‹Ø§â€¦ Ù„Ø§ ÙÙŠ Ø§Ù„Ø£ÙÙ„Ø§Ù…ØŒ ÙˆÙ„Ø§ ÙÙŠ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§ØªØŒ ÙˆÙ„Ø§ Ø­ØªÙ‰ ÙÙŠ Ø§Ù„Ù‚ØµØµ.

ÙƒÙ„Ù‡Ø§ Ù…Ø¬Ø±Ø¯ Ø£ÙˆÙ‡Ø§Ù… Ø¨Ø³ÙŠØ·Ø© Ø®ÙÙ„Ù‚Øª Ù„ØªØ¬Ø¹Ù„Ù†Ø§ Ù†ØªØ£Ø«Ø±ØŒ Ù†Ø¶Ø­Ùƒ Ø£Ùˆ Ù†Ø¨ÙƒÙŠâ€¦
ÙˆÙƒÙ„Ù‡Ø§ ÙƒÙØªØ¨Øª Ø£Ùˆ ØµÙÙ†Ø¹Øª Ù„ØªÙÙ‚Ø±Ø£ Ø£Ùˆ ØªÙØ´Ø§Ù‡Ø¯ Ù…Ø¹ Ù…Ù† ØªØ­Ø¨ØŒ Ù„Ø§ ÙˆØ­Ø¯Ùƒ â€” Ù„Ø£Ù†Ù‡Ø§ Ø³ØªØ¤Ù„Ù…Ùƒ Ø­ÙŠÙ† ØªÙ†ØªÙ‡ÙŠ.

Ø§Ù„Ø­Ø¨ Ø£Ø³Ø§Ø³ÙŠ ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ØŒ ÙˆØ£Ø¹Ù†ÙŠ Ø¨Ø§Ù„Ø­Ø¨ Ø£ÙŠ Ø´ÙŠØ¡ Ø£Ùˆ Ø£ÙŠ Ø´Ø®Øµâ€¦ Ù„ÙŠØ³ ÙÙ‚Ø· Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©ØŒ Ø¨Ù„ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† Ø£Ù†Ø§Ø³ Ù…Ù‚Ø±Ù‘Ø¨ÙŠÙ†ØŒ Ø´Ø±ÙƒØ§Ø¡ØŒ Ø£Ùˆ Ø­ØªÙ‰ Ø£ØµØ¯Ù‚Ø§Ø¡ â€” Ø£ØµØ¯Ù‚Ø§Ø¡ Ø­Ù‚ÙŠÙ‚ÙŠÙˆÙ† Ù…Ù‚Ø±Ù‘Ø¨ÙˆÙ†â€¦
ÙˆÙÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø©ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªØ­Ø¨ Ø´Ø®ØµÙ‹Ø§ Ø¨ØµØ¯Ù‚ Ø¥Ù† Ù„Ù… ÙŠÙƒÙ† ØµØ¯ÙŠÙ‚Ùƒ Ø£ÙˆÙ„Ù‹Ø§.

Ø£Ø±ÙˆØ§Ø­Ù†Ø§ Ø®ÙÙ„Ù‚Øª Ù„ØªØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø£Ø´Ø®Ø§Øµ Ù…Ø­Ø¯Ø¯ÙŠÙ† ÙÙ‚Ø·â€¦
Ø°Ù„Ùƒ Ø§Ù„Ø´Ø®Øµ Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ Ø£Ù† ÙŠØºÙŠÙ‘Ø±Ùƒ Ø­Ù‚Ù‹Ø§ â€” Ù„ÙŠØ³ Ø£Ù†Øª ÙÙ‚Ø· Ø¨Ù„ Ø§Ù„Ø¹Ø§Ù„Ù… Ù…Ù† Ø­ÙˆÙ„ÙƒØŒ ÙŠÙ…ÙƒÙ†Ù‡ Ø£Ù† ÙŠØºÙŠÙ‘Ø± Ø§Ù„Ø²Ù…Ø§Ù† ÙˆØ§Ù„Ù…ÙƒØ§Ù† ÙˆÙƒØ£Ù†Ù‡ Ø³Ø­Ø±.

Ù…Ø¹ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨:
ØªØµØ¨Ø­ Ø£Ø¬Ù…Ù„
Ù…Ù„Ø§Ù…Ø­Ùƒ ØªØªØºÙŠØ±
Ø¬Ø³Ø¯Ùƒ ÙŠØµØ¨Ø­ Ø£Ø®Ù
ØªØµØ¨Ø­ Ø£ÙƒØ«Ø± Ø­Ø³Ø§Ø³ÙŠØ©
ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ¨Ø¯Ùˆ Ø£Ø¬Ù…Ù„ØŒ Ø­ØªÙ‰ Ø£Ù„Ø·Ù Ù„Ù…Ø³Ø©â€¦
Ø±Ø§Ø¦Ø­ØªÙƒ ØªØµØ¨Ø­ Ø£Ø·ÙŠØ¨
Ø§Ø¨ØªØ³Ø§Ù…ØªÙƒ ØªØµÙŠØ± ØµØ§Ø¯Ù‚Ø©
ÙˆØªØ´Ø¹Ø± ÙØ¹Ù„Ù‹Ø§ Ø¨Ø¶Ø­ÙƒØªÙƒ Ø­ÙŠÙ† ØªØ®Ø±Ø¬ Ù…Ù† Ù‚Ù„Ø¨Ùƒ
 Ø§Ù„Ø·Ø¹Ø§Ù… ÙŠØµØ¨Ø­ Ø£Ù„Ø°
Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø£Ù†Ù‚Ù‰
Ø§Ù„Ø£Ø¬ÙˆØ§Ø¡ Ù…Ù…ÙŠØ²Ø© Ù„Ø§ ØªÙÙ†Ø³Ù‰
Ù„Ø­Ø¸Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ù„ÙƒÙ†Ù‡Ø§ Ù„Ø§ ØªÙÙ‚Ø¯Ù‘ÙØ± Ø¨Ø«Ù…Ù†
Ø­ØªÙ‰ Ø£ØºÙ†Ù‰ Ø§Ù„Ø£ØºÙ†ÙŠØ§Ø¡ Ù„Ø§ ÙŠØ³ØªØ·ÙŠØ¹ÙˆÙ† Ø´Ø±Ø§Ø¡Ù‡Ø§.

Ù„Ø§ ØªØ¸Ù† Ø£Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø³ØªØ¬Ø¹Ù„ ÙˆØµÙˆÙ„Ùƒ Ø¥Ù„Ù‰ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø£Ø³Ù‡Ù„â€¦
Ù‚Ù„Ø© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ù‚Ø¯ ØªØ¹Ø·ÙŠÙƒ ÙˆÙ‚ØªÙ‹Ø§ Ù„Ù…Ø§Ù„Ù Ø£ÙƒØ«Ø±ØŒ Ù„ÙƒÙ†Ù‡Ø§ Ù„Ù† ØªÙ…Ù†Ø­Ùƒ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© Ø£Ø¨Ø¯Ù‹Ø§.

ÙŠØ³Ø£Ù„ÙˆÙ†Ù†ÙŠ: Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØµØ¨Ø­ Ø­ÙŠÙ† ØªÙƒØ¨Ø±ØŸ ÙØ£Ø¬ÙŠØ¨: Ø£Ø±ÙŠØ¯ Ø£Ù† Ø£Ù†Ø¬Ø­ØŒ Ø£Ø±ÙŠØ¯ Ø£Ù† Ø£ÙƒÙˆÙ† Ø«Ø±ÙŠÙ‹Ø§.
Ù‡Ù… ÙŠÙÙƒØ±ÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø§Ù„ØŒ Ø£Ù…Ø§ Ø£Ù†Ø§ ÙØ£ÙÙƒØ± ÙÙŠ Ø¨Ø³Ø§Ø·Ø© Ø§Ù„Ø­ÙŠØ§Ø©â€¦ Ø£Ù† Ø£Ù…Ù„Ùƒ Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ø¹ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¹Ù„ Ø£Ø¨Ø³Ø· Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø£Ø«Ù…Ù† Ù…Ø§ ÙÙŠ Ø§Ù„ÙˆØ¬ÙˆØ¯.

ØªÙ„Ùƒ Ø§Ù„ÙˆØ¬Ø¨Ø© Ø§Ù„Ø±Ø®ÙŠØµØ© Ø§Ù„ØªÙŠ Ø§Ø´ØªØ±ÙŠØªÙ‡Ø§ Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…ØŒ Ø¨Ø¹Ø¯ Ø£Ù† Ø´Ø§Ø±ÙƒØª Ø¨Ø¹Ø¶ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù…Ø¹ ØµØ¯ÙŠÙ‚ÙŠ Ù„Ø£Ø³ØªØ·ÙŠØ¹ Ø¯ÙØ¹ Ø«Ù…Ù†Ù‡Ø§ØŒ
ÙƒØ§Ù†Øª Ø£Ù„Ø° Ø´ÙŠØ¡ Ø£ÙƒÙ„ØªÙ‡ ÙÙŠ Ø­ÙŠØ§ØªÙŠ.

ØªÙ„Ùƒ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ« Ø§Ù„ØªÙŠ ØªØ¨Ø¯Ùˆ Ø¨Ù„Ø§ Ù…Ø¹Ù†Ù‰ØŒ Ù†ØªÙƒÙ„Ù… Ø¹Ù† ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø©ØŒ
Ù„ÙƒÙ† ÙƒÙ„ ÙƒÙ„Ù…Ø© ØªØ­Ù…Ù„ Ù‚ÙŠÙ…Ø© ÙƒØ¨ÙŠØ±Ø©.

Ù„Ø§ ÙŠÙ‡Ù…Ù†Ø§ Ø­Ù‚Ù‹Ø§ Ø¹Ù…Ù‘Ø§ Ù†ØªØ­Ø¯Ø«ØŒ Ù…Ø§ ÙŠÙ‡Ù… Ù‡Ùˆ Ø£Ù†Ù†Ø§ Ù†ØªØ­Ø¯Ø«â€¦ Ø£Ù†Ù†Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù† â€” Ù…Ø¹Ù‹Ø§.
Ø£Ù† Ù†Ø³ØªØ·ÙŠØ¹ Ø§Ù„Ù†Ø¸Ø± ÙÙŠ Ø£Ø¹ÙŠÙ† Ø¨Ø¹Ø¶Ù†Ø§ Ø¯ÙˆÙ† Ø®Ø¬Ù„ Ø£Ùˆ ØºØ±Ø§Ø¨Ø©ØŒ
Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ØµÙ…Øª Ø§Ù„ØºÙŠØ± Ù…Ø±ÙŠØ­ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ù…Ø¬Ø±Ø¯ Ù„Ø­Ø¸Ø© Ø³Ù„Ø§Ù… Ø¨ÙŠÙ†Ù†Ø§.

Ù„ÙŠØ³ Ù„Ø¯ÙŠÙ†Ø§ Ø³ÙŠØ§Ø±Ø§ØªØŒ ÙÙ†Ù…Ø´ÙŠ Ù…Ø¹Ù‹Ø§ Ù†ØµÙ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØªØŒ ÙˆÙ†Ù‚ÙˆÙ„: â€œØ§Ù†ØªØ¨Ù‡ Ù„Ù†ÙØ³Ùƒâ€ØŒ Ø«Ù… Ù†ØªØµÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ù„Ù†ØªØ£ÙƒØ¯ Ø£Ù†Ù†Ø§ Ø¨Ø®ÙŠØ±.
Ù†Ø´Ø§Ø±Ùƒ Ø§Ù„Ø¹Ø·ÙˆØ± ÙˆØ§Ù„Ù…Ù„Ø§Ø¨Ø³ Ù…Ø¹Ù‹Ø§ØŒ
Ù†Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø£ÙÙ„Ø§Ù… Ø¹Ù„Ù‰ Ù‡ÙˆØ§ØªÙÙ†Ø§ Ø§Ù„ØµØºÙŠØ±Ø© Ù„Ø§Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø¨Ø·Ø¦.

ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ù‚Ø¨ÙŠØ­ ÙŠØµØ¨Ø­ Ø¬Ù…ÙŠÙ„Ù‹Ø§ Ù…Ø¹Ù‡Ù…â€¦
Ø§Ù„Ø±Ø®ÙŠØµ ÙŠØµØ¨Ø­ ØºØ§Ù„ÙŠÙ‹Ø§
Ø§Ù„Ù†ÙƒØ±Ø© ÙŠØµØ¨Ø­ Ø°Ø§ Ù…Ø¹Ù†Ù‰
Ø§Ù„Ù…ÙƒØ³ÙˆØ± ÙŠÙØµÙ„ÙØ­
Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ØªØµØ¨Ø­ Ø¨Ø·ÙˆÙ„Ø§Øª Ø¹Ø§Ù„Ù…ÙŠØ©
Ø§Ù„Ø¨ÙŠØª Ø§Ù„ØµØºÙŠØ± Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙŠØµØ¨Ø­ Ù‚ØµØ±Ù‹Ø§
ÙƒÙ„ Ø¶Ø­ÙƒØ© ØªØ¬Ø¹Ù„Ù†Ø§ Ø£ÙƒØ«Ø± Ø­ÙŠØ§Ø©
ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ØªØ²ÙŠØ¯ Ø«Ù‚ØªÙ†Ø§
ÙƒÙ„ ÙŠÙˆÙ… ÙŠØ¬Ø¹Ù„ ÙÙØ±Ø§Ù‚Ù†Ø§ Ø£ØµØ¹Ø¨.

ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ Ù‡Ø§ Ø£Ù†Ø§ Ù‡Ù†Ø§â€¦ (Ø§Ø¨ØªØ³Ø§Ù…Ø© Ø³Ø§Ø®Ø±Ø©).

Ù†Ø¸Ù† Ø£Ù†Ù†Ø§ Ù‚Ø§Ø¯Ø±ÙˆÙ† Ø¹Ù„Ù‰ Ø¥Ù†Ù‡Ø§Ø¡ ÙƒÙ„ Ø´ÙŠØ¡ ÙˆØ§Ù„Ù…Ø¶ÙŠ Ù‚ÙØ¯Ù…Ù‹Ø§: â€œØ«Ù…Ø§Ù†ÙŠØ© Ù…Ù„ÙŠØ§Ø±Ø§Øª Ø¥Ù†Ø³Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¶ØŒ Ø³Ø£ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø£Ù…Ø± ÙˆØ£Ø¬Ø¯ Ø´Ø®ØµÙ‹Ø§ Ø¢Ø®Ø±â€.
ØªÙ„Ùƒ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù…Ø´Ù‡ÙˆØ±Ø©â€¦ ÙŠØ§ Ù„Ù‡Ø§ Ù…Ù† ÙƒØ°Ø¨Ø© Ø¹Ø´Ù†Ø§ Ø­ÙŠØ§ØªÙ†Ø§ ÙˆÙ†Ø­Ù† Ù†Ø³Ù…Ø¹Ù‡Ø§.
Ø°Ù„Ùƒ Ø§Ù„Ø£Ù…Ø± Ù„Ù† ÙŠØ­Ø¯Ø«â€¦ ØªÙ„Ùƒ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„ØªÙŠ Ø¹Ø´ØªÙ‡Ø§ Ù…Ø¹ Ø°Ù„Ùƒ Ø§Ù„Ø´Ø®Øµ Ù„Ù† ØªØªÙƒØ±Ø± Ù…Ø¹ Ø£Ø­Ø¯ Ø¢Ø®Ø±.

Ø£Ù‚Ø³Ù… Ø£Ù† Ø§Ù„Ù„Ù‡ Ø®Ù„Ù‚ Ø£Ø±ÙˆØ§Ø­Ù†Ø§ Ù„ØªØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ù‚Ù„Ø© Ù†Ø§Ø¯Ø±Ø© Ù…Ù† Ø§Ù„Ù†Ø§Ø³ ÙÙ‚Ø·.

Ø£Ù„Ø§ ØªØ±Ù‰ Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø£Ø´Ø®Ø§ØµÙ‹Ø§ ØªÙ†Ø³Ø¬Ù… Ù…Ø¹Ù‡Ù… Ø¨Ø³Ø±Ø¹Ø© Ø¹Ø¬ÙŠØ¨Ø©ØŸ Ù‡Ø¤Ù„Ø§Ø¡ Ù‡Ù… Ø§Ù„Ø°ÙŠÙ† Ø®ÙÙ„ÙÙ‚ÙˆØ§ Ù„ÙŠÙƒÙˆÙ†ÙˆØ§ Ù…Ø¹Ùƒ.

Ø¥Ù† ÙˆØ¬Ø¯Øª Ø°Ù„Ùƒ Ø§Ù„Ø´Ø®Øµ Ø£Ùˆ Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø°ÙŠ Ø§Ù†Ø³Ø¬Ù…Øª Ù…Ø¹Ù‡ Ø­Ù‚Ù‹Ø§ØŒ ÙˆØ´Ø¹Ø±Øª Ù…Ø¹Ù‡ Ø¨ÙƒÙ„ Ù…Ø§ Ø°ÙƒØ±ØªÙ‡ Ø³Ø§Ø¨Ù‚Ù‹Ø§ØŒ ÙØ§Ø¨Ù‚Ù Ù…Ø¹Ù‡.
Ù„Ø§ ØªØªØ±ÙƒÙ‡!

Ù†Ø¹Ù… Ø³ØªØªØ´Ø§Ø¬Ø±Ø§Ù†ØŒ
Ø³ØªÙˆØ§Ø¬Ù‡Ø§Ù† Ù…Ø´Ø§ÙƒÙ„ Ø¹Ø¯ÙŠØ¯Ø©ØŒ
Ù„Ù† ØªØªÙÙ‚Ø§ Ø¯Ø§Ø¦Ù…Ù‹Ø§â€¦
Ù„ÙƒÙ† ÙƒÙ„ Ø®Ù„Ø§Ù Ø³ÙŠÙ‚ÙˆÙŠ Ø±Ø§Ø¨Ø·ÙƒÙ…Ø§ØŒ
Ø³ÙŠØ¬Ø¹Ù„ÙƒÙ…Ø§ ØªÙÙ‡Ù…Ø§Ù† Ø¨Ø¹Ø¶ÙƒÙ…Ø§ Ø£ÙƒØ«Ø±ØŒ
Ø³ØªØµÙ„Ø§Ù† Ø¥Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø¹Ø§Ù„Ù Ù…Ù† Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„ Ø§Ù„ØµØ¹Ø¨ Ø¨Ù„ÙˆØºÙ‡ Ù…Ø¹ Ø´Ø®Øµ Ø¢Ø®Ø±ØŒ
Ø³ØªØ¯Ø±ÙƒØ§Ù† Ø£Ù†Ù†Ø§ Ù„Ø³Ù†Ø§ ÙƒØ§Ù…Ù„ÙŠÙ†ØŒ Ù„ÙƒÙ†ÙƒÙ…Ø§ Ø³ØªØªØ¹Ù„Ù…Ø§Ù† Ø£Ù† ØªØ­Ø¨Ø§ Ù‡Ø°Ù‡ Ø§Ù„Ø¹ÙŠÙˆØ¨â€¦ ÙˆÙ‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø­Ø¨ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.

Ø¥ÙŠØ§Ùƒ Ø£Ù† ØªÙ†ÙØµÙ„ Ø¹Ù† Ø´Ø®Øµ Ù…Ù‚Ø±Ù‘Ø¨ Ù…Ù†Ùƒ Ø§Ù†ÙØµØ§Ù„Ù‹Ø§ Ø£Ø¨Ø¯ÙŠÙ‹Ø§ØŒ Ø³ÙŠØ·Ø§Ø±Ø¯Ùƒ Ø°Ù„Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¯â€¦
Ù„Ø£Ù†Ù‘ Ø±ÙˆØ­ÙŠÙƒÙ…Ø§ Ø³ØªØ¸Ù„Ø§Ù† Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ù…ØªØµÙ„ØªÙŠÙ†.

        </div>
        <div id="raw-fr-text" class="language-content" style="display: none;">
Les gens nâ€™ont jamais vraiment montrÃ© ce que lâ€™amour ressent vraiment, ni au cinÃ©ma, ni dans les sÃ©ries, ni mÃªme dans les histoires.

Ce ne sont que des fantasmes triviaux pour nous Ã©mouvoir, nous faire rire ou pleurerâ€¦

Et tout cela est fait pour Ãªtre lu ou regardÃ© avec quelquâ€™un que lâ€™on aime, pas seul â€” parce que Ã§a fait mal quand Ã§a se termine.

Lâ€™amour est essentiel dans nos vies, et par Â« amour Â» jâ€™entends nâ€™importe quoi, nâ€™importe qui â€” ce nâ€™est pas seulement la romance ; Ã§a peut Ãªtre entre des proches, des partenaires, ou des amis â€” de vrais amis trÃ¨s prochesâ€¦
Et on ne peut pas vraiment aimer quelquâ€™un sans dâ€™abord Ãªtre son ami.

Nos Ã¢mes sont faites pour nâ€™appartenir quâ€™Ã  certaines personnesâ€¦

De sorte que cette personne peut rÃ©ellement te transformer â€” littÃ©ralementâ€¦ pas seulement toi, mais aussi le monde autour de toi ; elle peut, comme par magie, manipuler le temps et lâ€™espace.

Avec la bonne personne
Tu deviens plus beau / plus belle
Tes traits changent
Ton corps se sent plus lÃ©ger
Tu deviens plus sensible
Tout paraÃ®t mieux, mÃªme le toucher le plus lÃ©gerâ€¦
Tu sens meilleur
Ton sourire devient vrai
Tu sens vraiment quand tu ris du fond du cÅ“ur
La nourriture a un goÃ»t incroyable
Lâ€™air devient plus frais
Les ambiences sont si particuliÃ¨res quâ€™elles ne sâ€™oublient pas
Des moments si simples mais inestimables
MÃªme les plus riches ne peuvent pas les acheter.
Ne crois pas que la solitude facilitera lâ€™atteinte de tes objectifsâ€¦

Avoir moins dâ€™amis peut te donner du temps pour gagner plus dâ€™argent, mais Ã§a ne te rendra jamais plus heureux.

On me demande ce que je veux devenir quand je serai grand, je rÃ©ponds : je veux rÃ©ussir, je veux devenir riche.

Ils pensent Ã  lâ€™argent, mais moi je pense Ã  la simplicitÃ© de la vie, Ã  avoir peu, mais avec la vrai personne qui rend les choses les plus simples les plus prÃ©cieuses.

Ce repas bon marchÃ© que jâ€™ai achetÃ© au restaurant, en partageant quelques piÃ¨ces avec mon ami pour pouvoir se le permettre,
Ã©tait la chose la plus dÃ©licieuse que jâ€™aie jamais goÃ»tÃ©e.

Ces conversations apparemment insignifiantes quâ€™on a, oÃ¹ lâ€™on parle de tous les sujets de la vie â€”
pourtant chaque mot compte Ã©normÃ©ment.

Ce qui importe vraiment, ce nâ€™est pas de quoi on parle ; ce qui compte, câ€™est que lâ€™on parle, que nous soyons lÃ  â€” ensemble.
Que lâ€™on puisse se regarder dans les yeux sans timiditÃ© ni gÃªne.
Que le silence gÃªnant quâ€™on aurait avec dâ€™autres devient pour nous un moment de paix.

Nous nâ€™avons pas de voiture, alors on se raccompagne Ã  mi-chemin en se disant Â« prends soin de toi Â» puis on sâ€™appelle plus tard pour vÃ©rifier que tout va bien.
Ou quand on se prÃªte nos parfums et nos vÃªtements.
Ou quâ€™on regarde des films sur nos petits tÃ©lÃ©phones parce que notre Wi-Fi est nul.

Tout ce qui est laid devient beau avec euxâ€¦
Le bon marchÃ© devient prÃ©cieux
Lâ€™insignifiant devient plein de sens
Le brisÃ© se rÃ©pare
Les jeux quâ€™on fait deviennent champions du monde
La petite maison ancienne devient un chÃ¢teau
Chaque rire nous rend plus vivants
Chaque minute renforce notre confiance
Chaque jour rend la sÃ©paration de plus en plus impossible.

Et pourtant me voilÃ , lolâ€¦

On croit quâ€™on peut tout effacer et passer Ã  autre chose â€” Â« 8 milliards de personnes sur terre, je mâ€™en remettrai et jâ€™en trouverai une autre. Â»

Cette fameuse phraseâ€¦ quel mensonge on nous a toujours racontÃ©.
Tu nâ€™y arriveras pasâ€¦ ces sentiments que tu as eus avec cette personne ne se rÃ©pÃ©teront pas avec une autre.

Je jure que Dieu a crÃ©Ã© nos Ã¢mes pour ne sâ€™accorder quâ€™avec quelques autres, rares Ã  trouver.

Ne vois-tu pas quâ€™il y a des gens avec qui on sâ€™entend tout de suite ? Ce sont ceux qui sont destinÃ©s Ã  Ãªtre avec toi.

Si tu trouves (ou as trouvÃ©) cette personne ou cet ami avec qui tu tâ€™entends parfaitement et que tu as ressenti tout ce que jâ€™ai dÃ©crit plus haut, alors reste.
Ne pars pas !

Oui, vous vous battrez
Vous aurez des problÃ¨mes
Vous ne serez pas toujours dâ€™accord
Mais chaque lutte renforcera votre lien
Vous vous comprendrez mieux
Vous atteindrez un niveau de comprÃ©hension difficile Ã  atteindre avec un autre
Vous comprendrez que nous ne sommes pas parfaits mais que lâ€™on apprend Ã  aimer ces imperfections â€” et câ€™est Ã§a le vÃ©ritable amour.

Ne te sÃ©pare jamais dÃ©finitivement dâ€™un proche, cela te hantera pour toujours.

Parce que vos Ã¢mes resteront toujours liÃ©esâ€¦
        </div>
        <div id="raw-en-text" class="language-content" style="display: none;">            
            People never really showed how love really feels like, not in movies not in shows not even in stories.

These are all trivial fantasies to make us emotional, laugh or cryâ€¦.

And all of them were meant to be read or watched with someone you love, not alone â€” because they will hurt you when they end.

Love is essential in/for ours lives, and by love I mean anything,anyone â€” itâ€™s not just romance, it can be between close people, partners ,or friends â€” real close friendsâ€¦
And you actually canâ€™t really love someone without being your friend.

Ours souls are only meant to belong with certain peopleâ€¦

So that  person can actually change you â€” literallyâ€¦ not only you but also the world around you, they can manipulate time and space like magic


With the right one
You become more beautiful
your facial features changes
your body feels lighter 
You become more sensitive 
Everything feels better, even the lightest touchâ€¦
You smell better 
Your smile becomes real 
You actually can feel it when you laugh out of your heart
The food tastes really good 
The air becomes fresher 
The vibes are so special they cannot be forgotten 
Moments so simple yet they are priceless 
Not even the richest people can buy them.
Donâ€™t think being alone would make reaching your goals easierâ€¦

Less friends might give you time for more money, but it will never make you happier.

They ask me what do I want to be when I grow up, I reply: I want to be successful, I want to be rich.

They think about money, but I think about the simplicity of life, to have a little but with the right person who makes the simplest things the most valuable  

That cheap meal i bought from the restaurant, sharing some coins with my friend to afford it 
Was the most delicious thing Iâ€™ve ever had 

Those meaningless conversations we have, talking about every subject in life 
Yet every word means a lot 

We donâ€™t really care about what weâ€™re talking about, what we really care about is that we are talking, that we areâ€¦there â€” together
That we can look in each otherâ€™s eyes without being shy or feeling uncomfortable 
That the awkward silence we usually have with other people is just a moment of peace for us.
We have no cars so we walk each other half way home saying take care of yourself and later call to make sure we are alright 
Or when we share perfumes and clothes together 
Or watch movies on our small phones because we have a shitty WiFi 

Everything ugly becomes beautiful with themâ€¦
The cheap becomes expensive 
The meaningless becomes meaningful 
The broken gets fixed 
The games we play becomes world champion 
The small old home becomes a castle 
Every giggle makes us more alive 
Every minute makes our trust stronger
Every day makes our separation more impossible.

Yet here I am, lolâ€¦
 
We think that we can just end it all and move on  â€œ8billion people on earth,ill get over it and find someone elseâ€  

That famous sentence, oh what a lie we have always been hearing.
You wonâ€™tâ€¦ those feelings you got with that someone wonâ€™t be repeated again with another one.

I swear, God has created our souls to only match with a few which are rare to find

Donâ€™t you see that there are people who you get along with too fast, thatâ€™s the ones who are meant to be with you

If you find or found that person or friend you really get along with and felt all the things I mentioned before with them, then stay.
Donâ€™t leave ! 

Yes you will fight 
You will have problems 
You wonâ€™t always agree 
But every struggle will make your bound stronger 
Youâ€™ll understand each other more 
You will reach a high level of understanding that itâ€™s hard to achieve with another 
You will understand that we are not perfect but youâ€™ll learn to fall in love with these imperfections and thatâ€™s true love.

Donâ€™t you ever separate with a close one permanently, it will haunt you forever

Because your souls will always be connectedâ€¦
        </div>
        <div id="content" class="rounded-lg mx-auto content-fading">
            <h1 id="title" class="text-3xl font-bold mb-12"></h1>
            <div id="text-container" class="text-lg leading-relaxed">
                <!-- Pre-rendered English content for SEO -->
            </div>
        </div>
        <!-- REFACTOR: Changed the save button to a circular icon button. -->
        <button
            id="save-progress-button"
            class="fixed bottom-4 left-4 w-14 h-14 rounded-full flex items-center justify-center transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none glass-button-base save-button-custom"
            style="z-index: 60;"
            aria-label="Scroll to saved progress"
        >
            <!-- Bookmark Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" /></svg>
        </button>
        <div id="popup" class="fixed inset-0 flex items-center justify-center z-50">
            <div class="glass-button-base glass-popup shadow-lg w-64 fade-in">
                <!-- REFACTOR: Add a flex container to align the icon and title text. -->
                <div class="flex items-center justify-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg>
                    <h2 id="popup-title" class="text-lg font-bold">Save Position</h2>
                </div>
                <p id="popup-text" class="mb-4 text-sm"></p> <!-- FIX: Add text-center to center the question. -->
                <div class="flex justify-end space-x-2">
                    <button
                        id="popup-save-button"
                        class="glass-button-base bg-green-500 text-white px-4 py-2 rounded-full focus:outline-none"
                    >
                        Save
                    </button>
                    <button
                        id="popup-exit-button"
                        class="glass-button-base bg-red-500 text-white px-4 py-2 rounded-full focus:outline-none"
                    >
                        Exit
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- FIX: Consolidate all story initialization logic into a single module script to resolve loading race conditions. -->
    <script type="module">
        // --- Firebase Initialization ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut, setPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getDatabase, ref, onValue, onDisconnect, serverTimestamp, push, set } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
        // --- Story Script ---
        // This imports the main story logic. The functions will be available in this module's scope.
        import { initializeStoryContent, initializeAuth } from '../story-script.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBIlDy8iaEpCHVc6kPij_zh2zHJYQqiShk",
            authDomain: "dodchstories-435bb.firebaseapp.com",
            databaseURL: "https://dodchstories-435bb-default-rtdb.firebaseio.com",
            projectId: "dodchstories-435bb",
            storageBucket: "dodchstories-435bb.firebasestorage.app",
            messagingSenderId: "52323489131",
            appId: "1:52323489131:web:1ac8292a3953032715682e",
            measurementId: "G-7MCXBETRYQ"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app);

        // Make Firebase services globally available for the imported script.
        const firebaseServices = { 
            db: database, 
            auth: auth, 
            onAuthStateChanged: onAuthStateChanged, 
            ref, onValue, onDisconnect, serverTimestamp, push, set,
            // NEW: Pass all required auth functions
            GoogleAuthProvider, signInWithPopup, signOut, setPersistence, browserSessionPersistence
        };

        // Story-specific configuration
        const contentMap = {
            ar: {
                title: 'Ù…Ø¹ Ø§Ù„Ø´Ø®Øµ Ø§Ù„ØµØ­',
                rawTextId: 'raw-ar-text',
                savePosition: 'Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ù…Ø±Ø¬Ø¹ÙŠØ©',
                save: 'Ø­ÙØ¸',
                exit: 'Ø®Ø±ÙˆØ¬',
                bookmarkQuestion: 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© Ø¹Ù†Ø¯ ÙƒÙ„Ù…Ø©: "{word}"ØŸ',
                questionMark: 'ØŸ', // FIX: Use Arabic question mark
                atWord: '', // No longer needed
                positionSaved: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
                forWord: 'Ù„ÙƒÙ„Ù…Ø©',
                wordNotFound: 'Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ø§Ù„ÙŠ.',
                noWordSaved: 'Ù„Ù… ÙŠØªÙ… Ø­ÙØ¸ Ø£ÙŠ ÙƒÙ„Ù…Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù„ØºØ© Ø¨Ø¹Ø¯'
            },
            fr: {
                title: 'Avec la vraie personne',
                rawTextId: 'raw-fr-text',
                savePosition: 'Ajouter un marque-page',
                save: 'Enregistrer',
                exit: 'Sortir',
                bookmarkQuestion: 'Mettre en favori cette position au mot : "{word}" ?',
                questionMark: '?',
                atWord: '', // No longer needed
                positionSaved: 'Position enregistrÃ©e',
                forWord: 'pour le mot',
                wordNotFound: 'Le mot enregistrÃ© n\'a pas Ã©tÃ© trouvÃ© dans le texte actuel.',
                noWordSaved: 'Aucun mot n\'a Ã©tÃ© enregistrÃ© pour cette langue encore'
            },
            en: {
                title: 'With the right person',
                rawTextId: 'raw-en-text',
                savePosition: 'Bookmark',
                save: 'Save',
                exit: 'Exit',
                bookmarkQuestion: 'Bookmark this position at the word: "{word}"?',
                questionMark: '?',
                atWord: '', // No longer needed
                positionSaved: 'Position saved at',
                forWord: 'for the word',
                wordNotFound: 'Saved word not found in current text.',
                noWordSaved: 'No word has been saved for this language yet'
            },
        };

        (async () => {
            // FIX: The core issue was that `firebaseServices` was not being passed to the initialization function,
            // causing all database operations (like saving bookmarks) to fail. This is now corrected.
            // This also ensures all initialization happens in the correct, sequential order to prevent race conditions.
            
            // 1. Initialize the story content and get the user ID.
            const userId = await initializeStoryContent(contentMap, firebaseServices);
            // 2. Initialize the authentication button.
            initializeAuth(firebaseServices);

            const visitorCountElement = document.getElementById('visitor-count');
            const storyId = document.title.toLowerCase().replace(/[^a-z0-9-]/g, '').replace(/\s+/g, '-');
            const storyVisitorsRef = ref(database, `presence/${storyId}`);            
            // NEW: Get the eye icon to animate it.
            const visitorIcon = document.querySelector('#visitor-count-container svg');
            
            // Listen for changes and update the UI with the correct visitor count.
            onValue(storyVisitorsRef, (snapshot) => {
                if (!visitorCountElement) return;
                const data = snapshot.val();
                const count = data ? Object.keys(data).length : 0;

                // FIX: Animate only when the count actually changes.
                const currentCount = parseInt(visitorCountElement.textContent, 10);
                if (count !== currentCount) {
                    visitorCountElement.textContent = count;
                    // Trigger animations
                    if (visitorIcon) {
                        // Determine which glow to use: green for join, red for leave.
                        const glowClass = count > currentCount ? 'visitor-join-glow' : 'visitor-leave-glow';

                        // FIX: Use a double requestAnimationFrame for the most reliable animation restart.
                        // This guarantees a full frame passes between removing and re-adding the class,
                        // forcing the browser to re-trigger the animation every time.
                        visitorIcon.classList.remove('visitor-join-glow', 'visitor-leave-glow');
                        requestAnimationFrame(() => {
                            requestAnimationFrame(() => {
                                visitorIcon.classList.add(glowClass);
                            });
                        });
                    }
                    visitorCountElement.classList.add('count-pop-animation');
                    visitorCountElement.addEventListener('animationend', () => visitorCountElement.classList.remove('count-pop-animation'), { once: true });
                }
            });

            // Use the .info/connected path to manage online status.
            // This is the official Firebase pattern for robust presence.
            const connectedRef = ref(database, '.info/connected');
            onValue(connectedRef, (snap) => {
                if (snap.val() === true) {
                    // We're connected (or reconnected).
                    // 1. Create a new, unique reference for this specific connection.
                    const myConnectionRef = push(storyVisitorsRef);

                    // 2. When the client disconnects, remove their entry.
                    onDisconnect(myConnectionRef).remove();

                    // 3. Set the value to mark the user as "online".
                    set(myConnectionRef, serverTimestamp());
                }
            });
        })();

    </script>
</body>
</html>
